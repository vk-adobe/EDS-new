/*! For license information please see BillingForm.js.LICENSE.txt */
import*as t from"@dropins/elsie/event-bus.js";import*as e from"@dropins/elsie/fetch-graphql.js";import*as r from"@dropins/elsie/preact-compat.js";import*as n from"@dropins/elsie/preact-hooks.js";import*as o from"@dropins/elsie/preact-jsx-runtime.js";import*as a from"@dropins/elsie/preact.js";export const id=908;export const ids=[908];export const modules={1468:(t,e,r)=>{r.d(e,{su:()=>p,vY:()=>h,nc:()=>v});var n=r(3838),o=r(245),a=r(7096),i="\n  mutation setShippingAddress($cartId: String!, $address: CartAddressInput!) {\n    setShippingAddressesOnCart(\n      input: { cart_id: $cartId, shipping_addresses: [{ address: $address }] }\n    ) {\n      cart {\n        id\n        ...CheckoutData\n        ...CartSummaryItems\n      }\n    }\n  }\n  ".concat(a.mr,"\n  ").concat(a.G,"\n"),s=r(9885);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function d(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),s=new F(n||[]);return o(i,"_invoke",{value:I(t,r,s)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var h="suspendedStart",v="suspendedYield",m="executing",y="completed",g={};function b(){}function w(){}function x(){}var _={};f(_,i,(function(){return this}));var j=Object.getPrototypeOf,E=j&&j(j(G([])));E&&E!==r&&n.call(E,i)&&(_=E);var C=x.prototype=b.prototype=Object.create(_);function L(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,i,s){var c=p(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,s)}),(function(t){r("throw",t,i,s)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function I(e,r,n){var o=h;return function(a,i){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var u=k(s,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?y:v,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function k(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,k(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=p(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function G(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(C,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},L(S.prototype),f(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new S(d(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},L(C),f(C,l,"Generator"),f(C,i,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=G,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:G(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function l(t,e,r,n,o,a,i){try{var s=t[a](i),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],u=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var p=["city","company","country_code","firstname","lastname","postcode","region","region_id","save_in_address_book","street","telephone","vat_id"],h=function(t){var e={city:t.city,company:t.company,country_code:t.country_id,firstname:t.firstname,lastname:t.lastname,postcode:t.postcode,save_in_address_book:!t.save_in_address_book,street:(0,o.S)("street",t),telephone:t.telephone,vat_id:t.vat_id,region:t.region};t.region_id&&(e.region_id=parseInt(t.region_id,10));var r=Object.keys(t).filter((function(t){return!t.startsWith("street")})).filter((function(t){return!p.includes(t)})).filter((function(t){return"country_id"!==t})).map((function(e){var r=f(e.split(n.EC),2),a=r[0];return r[1]?{attribute_code:a,value:(0,o.S)(a,t).join(n.M0)}:{attribute_code:a,value:t[e]}})).filter((function(t,e,r){return e===r.findIndex((function(e){return e.attribute_code===t.attribute_code}))}));return r.length>0&&(e.custom_attributes=r),e},v=function(){var t,e=(t=c().mark((function t(e){var r,n,o,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.signal,n=e.cartId,o=e.address,t.next=3,(0,s.x)({query:i,options:{signal:r,variables:{cartId:n,address:o}},path:"setShippingAddressesOnCart.cart",signalType:"cart"});case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){l(a,n,o,i,s,"next",t)}function s(t){l(a,n,o,i,s,"throw",t)}i(void 0)}))});return function(t){return e.apply(this,arguments)}}()},3838:(t,e,r)=>{r.d(e,{EC:()=>n,M0:()=>o,xE:()=>a});var n="-",o="\n",a=2e3},6374:(t,e,r)=>{r.d(e,{U:()=>h});var n=r(845),o=r(1468),a=r(9636),i=r(7238),s=r(1497),u=r(8393),c=r(7294),l=r(3042),f=r(4853),d=r(7188),p=(0,f.lazy)((function(){return Promise.all([r.e(79),r.e(499),r.e(457),r.e(753)]).then(r.bind(r,8753))})),h=function(){var t=(0,s.oR)().cartId,e=(0,c.l)().fields,r=(0,u.Mg)().isBillToShipping,h=(0,f.useRef)(null),v=!r.value,m=(0,f.useCallback)((function(e){return(0,n.w)({signal:e.signal,cartId:t,input:{address:r.value?void 0:(0,o.vY)(e.address),same_as_shipping:r.value}})}),[t,r.value]),y=(0,f.useCallback)((function(){var t,r=l.t.value.data;return!(0,a.I)(e,null==r||null===(t=r.shipping_addresses)||void 0===t?void 0:t[0],null==r?void 0:r.billing_address)}),[e]);return(0,f.useEffect)((function(){var t,e=new AbortController;!1===r.value&&(null===(t=h.current)||void 0===t||t.triggerSaveAddress(e.signal));return function(){e.abort()}}),[r.value]),(0,d.jsx)(f.Suspense,{fallback:(0,d.jsx)("div",{children:"loading..."}),children:(0,d.jsx)(p,{ref:h,name:i.U,addressType:"billing_address",headingId:"Checkout.BillingAddress.title",saveAddressHandler:m,shouldAutoFillForm:y,style:{display:v?"block":"none"},"data-testid":"billing-form"})})}},7238:(t,e,r)=>{r.d(e,{U:()=>n});var n="billing_address"},8994:(t,e,r)=>{r.d(e,{U1:()=>n.U,UG:()=>o.U,ZP:()=>n.U});var n=r(6374),o=r(7238)},245:(t,e,r)=>{r.d(e,{S:()=>o});var n=r(3838),o=function(t,e){return Object.keys(e).filter((function(e){return e.startsWith(t)})).sort((function(e,r){return parseInt(e.replace("".concat(t).concat(n.EC),""),10)-parseInt(r.replace("".concat(t).concat(n.EC),""),10)})).map((function(t){return e[t]}))}},6765:(e,r,n)=>{e.exports=(t=>{var e={};return n.d(e,t),e})({events:()=>t.events})},9699:(t,r,n)=>{t.exports=(t=>{var e={};return n.d(e,t),e})({FetchGraphQL:()=>e.FetchGraphQL})},4853:(t,e,n)=>{t.exports=(t=>{var e={};return n.d(e,t),e})({Suspense:()=>r.Suspense,createContext:()=>r.createContext,forwardRef:()=>r.forwardRef,lazy:()=>r.lazy,useCallback:()=>r.useCallback,useContext:()=>r.useContext,useEffect:()=>r.useEffect,useImperativeHandle:()=>r.useImperativeHandle,useMemo:()=>r.useMemo,useRef:()=>r.useRef,useState:()=>r.useState})},5437:(t,e,r)=>{t.exports=(t=>{var e={};return r.d(e,t),e})({useCallback:()=>n.useCallback,useContext:()=>n.useContext,useDebugValue:()=>n.useDebugValue,useEffect:()=>n.useEffect,useId:()=>n.useId,useImperativeHandle:()=>n.useImperativeHandle,useLayoutEffect:()=>n.useLayoutEffect,useMemo:()=>n.useMemo,useReducer:()=>n.useReducer,useRef:()=>n.useRef,useState:()=>n.useState})},4142:(t,e,r)=>{t.exports=(t=>{var e={};return r.d(e,t),e})({Fragment:()=>o.Fragment,jsx:()=>o.jsx,jsxs:()=>o.jsxs})},3474:(t,e,r)=>{t.exports=(t=>{var e={};return r.d(e,t),e})({Component:()=>a.Component,Fragment:()=>a.Fragment,cloneElement:()=>a.cloneElement,createContext:()=>a.createContext,createElement:()=>a.createElement,createRef:()=>a.createRef,h:()=>a.h,hydrate:()=>a.hydrate,isValidElement:()=>a.isValidElement,options:()=>a.options,render:()=>a.render,toChildArray:()=>a.toChildArray})}};import i from"../runtime.js";import*as s from"../179.js";i.C(s);import*as u from"../900.js";i.C(u);import*as c from"../840.js";i.C(c);import*as l from"../965.js";i.C(l);import*as f from"../483.js";i.C(f);import*as d from"../378.js";i.C(d);import*as p from"../636.js";i.C(p);import*as h from"./BillingForm.js";i.C(h);var v,m=(v=8994,i(i.s=v)),y=m.UG,g=m.U1,b=m.ZP;export{y as BILLING_FORM_NAME,g as BillingForm,b as default};