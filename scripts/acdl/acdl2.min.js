function e(){if(window.adobeDataLayer&&window.adobeDataLayer._eventListeners)return void console.debug("ACDL already initialized, skip");function e(...t){const a=e=>e&&"object"==typeof e;return t.reduce(((t,n)=>(Object.keys(n).forEach((o=>{const r=t[o],i=n[o];Array.isArray(r)&&Array.isArray(i)?t[o]=i.filter((e=>e)):a(r)&&a(i)?t[o]=e(r,i):null==i?delete t[o]:t[o]=i})),t)),{})}function t(e,t){const a=t.split(".");let n=e;for(const e of a)if(n=n[e],null==n)return;return n}window.adobeDataLayer._eventListeners={},window.adobeDataLayer.getState=function(a,n,o={}){const{flatten:r=!0,addEvents:i=!1,until:d,addIndex:s=!1}=o;let l=[];if("past"!==n||window.acdlDisableStorage)if(Number.isInteger(n)&&!window.acdlDisableStorage){const e=window.acdlIndex+n;l.push(JSON.parse(window.sessionStorage.getItem(`acdl:${e}`))||[])}else if(Array.isArray(n)&&2===n.length&&n.every((e=>Number.isInteger(e)))&&!window.acdlDisableStorage){const e=[];for(let t=n[0];t<=n[1];t+=1)e.push(window.acdlIndex+t);e.forEach((e=>{const t=window.sessionStorage.getItem(`acdl:${e}`);t&&l.push([...JSON.parse(t),...s?[{_index:e}]:[]])}))}else l.push(window.adobeDataLayer.filter((e=>"function"!=typeof e)));else{Object.keys(window.sessionStorage).filter((e=>e.startsWith("acdl:"))).filter((e=>e!==`acdl:${window.acdlIndex}`)).sort(((e,t)=>e.localeCompare(t,"en",{numeric:!0}))).map((e=>e.replace("acdl:",""))).forEach((e=>{l.push([...JSON.parse(window.sessionStorage.getItem(`acdl:${e}`)),...s?[{_index:e}]:[]])}))}l=r?[l.flat()]:l;const w=l.map((n=>{let o={};for(const t of n)if(o=e(o,t),d&&JSON.stringify(t)===JSON.stringify(d))break;if(delete o.event,delete o.eventInfo,i){const e=n.filter((e=>e.event));e.length>0&&(o.events=e)}return r&&delete o._index,a?t(o,a):o})).filter((e=>void 0!==e));return 1===w.length?w[0]:w.length>1?w:void 0},window.adobeDataLayer.addEventListener=function(e,a,n={}){const{scope:o="all"}=n;(window.adobeDataLayer._eventListeners[e]||[]).find((e=>e.handler===a))||("future"!==o&&"all"!==o||(window.adobeDataLayer._eventListeners[e]=(window.adobeDataLayer._eventListeners[e]||[]).concat({handler:a,options:n})),"past"!==o&&"all"!==o||function(e,a,n){if("adobeDataLayer:change"===e){let e=window.adobeDataLayer.filter((e=>"function"!=typeof e&&Object.keys(e).filter((e=>"event"!==e&&"eventInfo"!==e)).length>0));return n&&n.path&&(e=e.filter((e=>void 0!==t(e,n.path)))),void e.forEach((e=>a(e)))}let o=window.adobeDataLayer.filter((e=>"function"!=typeof e&&e.event));"adobeDataLayer:event"!==e&&(o=o.filter((t=>t.event===e))),o.forEach((e=>{const t=window.adobeDataLayer.getState(null,0,{until:e});a(e,t)}))}(e,a,n))},window.adobeDataLayer.removeEventListener=function(e,t){window.adobeDataLayer._eventListeners[e]=t?(window.adobeDataLayer._eventListeners[e]||[]).filter((e=>e.handler!==t)):[]};const a=window.adobeDataLayer.push;window.adobeDataLayer.push=function(...e){e.filter((e=>"function"==typeof e)).forEach((e=>e(this)),window.adobeDataLayer);const n=e.filter((e=>"function"!=typeof e));a(...n),n.forEach((e=>function(e){const a=[];let n={};e.event&&"adobeDataLayer:change"!==e.event&&"adobeDataLayer:event"!==e.event&&((window.adobeDataLayer._eventListeners["adobeDataLayer:event"]||[]).length>0&&a.push(...window.adobeDataLayer._eventListeners["adobeDataLayer:event"]),(window.adobeDataLayer._eventListeners[e.event]||[]).length>0&&a.push(...window.adobeDataLayer._eventListeners[e.event]),n=window.adobeDataLayer.getState()),(window.adobeDataLayer._eventListeners["adobeDataLayer:change"]||[]).length>0&&Object.keys(e).filter((e=>"event"!==e&&"eventInfo"!==e)).length>0&&a.push(...window.adobeDataLayer._eventListeners["adobeDataLayer:change"]),a.forEach((a=>{a.options&&a.options.path&&!t(e,a.options.path)||a.handler(e,n)}))}(e)))},window.adobeDataLayer.forEach((function(e){"function"==typeof e&&e(this)}),window.adobeDataLayer),window.adobeDataLayer.forEach(((e,t)=>"function"==typeof e&&window.adobeDataLayer.splice(t,1)))}export default e;e();